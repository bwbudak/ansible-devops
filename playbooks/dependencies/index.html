<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://ibm-mas.github.io/ansible-devops/playbooks/dependencies/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Dependencies Playbooks - MAS Devops Collection</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="../../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Dependencies Playbooks";
    var mkdocs_page_input_path = "playbooks/dependencies.md";
    var mkdocs_page_url = "/ansible-devops/playbooks/dependencies/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> MAS Devops Collection</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Full Stack Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../fullstack-roks/">IBM Cloud</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Lite Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../lite-core-roks/">Core only on IBM Cloud</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../lite-core-quickburn/">Core only on QuickBurn</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../lite-manage-roks/">Manage on IBM Cloud</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Other Playbooks</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../ocp/">OCP Playbooks</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Dependencies Playbooks</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#install-amq-streams">Install AMQ Streams</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#required-environment-variables">Required environment variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#optional-environment-variables">Optional environment variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example-usage">Example usage</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#install-mongodb-ce">Install MongoDb (CE)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#required-environment-variables_1">Required environment variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#optional-environment-variables_1">Optional environment variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example-usage_1">Example usage</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#install-bas">Install BAS</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#required-environment-variables_2">Required environment variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#optional-environment-variables_2">Optional environment variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#usage">Usage:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#install-sls">Install SLS</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#required-environment-variables_3">Required environment variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#optional-environment-variables_3">Optional environment variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example-usage-release-build">Example usage: release build</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example-usage-pre-release-build">Example usage: pre-release build</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d/">CP4D Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../mas/">MAS Playbooks</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Roles</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/amqstreams/">amqstreams</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/bas_install/">bas_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_db2wh/">cp4d_db2wh</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_db2wh_manage_hack/">cp4d_db2wh_manage_hack</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_install/">cp4d_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_install_services/">cp4d_install_services</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/install_operator/">install_operator</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/mongodb/">mongodb</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_deprovision/">ocp_deprovision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_login/">ocp_login</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_provision/">ocp_provision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_setup_github_oauth/">ocp_setup_github_oauth</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_setup_mas_deps/">ocp_setup_mas_deps</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_setup_ocs/">ocp_setup_ocs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/sls_install/">sls_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_configure/">suite_app_configure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_install/">suite_app_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_config/">suite_config</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_dns/">suite_dns</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_install/">suite_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_verify/">suite_verify</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">MAS Devops Collection</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Other Playbooks &raquo;</li>
        
      
    
    <li>Dependencies Playbooks</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/playbooks/dependencies.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="depedencies-playbooks">Depedencies Playbooks<a class="headerlink" href="#depedencies-playbooks" title="Permanent link"></a></h1>
<h2 id="install-amq-streams">Install AMQ Streams<a class="headerlink" href="#install-amq-streams" title="Permanent link"></a></h2>
<h3 id="required-environment-variables">Required environment variables<a class="headerlink" href="#required-environment-variables" title="Permanent link"></a></h3>
<ul>
<li><code>KAFKA_STORAGE_CLASS</code> sets the storage class to use for both Kafka and Zookeeper</li>
<li><code>MAS_INSTANCE_ID</code> sets the instance ID of the MAS install that we are configuring</li>
</ul>
<h3 id="optional-environment-variables">Optional environment variables<a class="headerlink" href="#optional-environment-variables" title="Permanent link"></a></h3>
<ul>
<li><code>KAFKA_NAMESPACE</code> overrides the Kubernetes namespace where the AMQ streams operator will be installed, this will default to <code>amq-streams</code></li>
<li><code>KAFKA_CLUSTER_NAME</code> overrides the name Kafka cluster, this will default <code>maskafka</code></li>
<li><code>KAFKA_CLUSTER_SIZE</code> provides a choice between a small and large cluster configuration, this will default to <code>small</code></li>
<li><code>KAFKA_USER_NAME</code> configures the user that will be created for MAS, will default to <code>masuser</code></li>
</ul>
<h3 id="example-usage">Example usage<a class="headerlink" href="#example-usage" title="Permanent link"></a></h3>
<p>AMQ Streams operator will be installed into the <code>amq-streams</code> namespace, a cluster named <code>maskafka</code> will be created using the small configuration and <code>ibmc-block-gold</code> as the storage class.</p>
<pre><code class="language-bash">export KAFKA_STORAGE_CLASS=ibmc-block-gold
export MAS_INSTANCE_ID=masdev1

ansible-playbook playbooks/dependencies/install-amqstreams.yml
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The playbook will generate a yaml file containing the definition of a Secret and KafkaCfg resource that can be used to configure the deployed cluster as the MAS system Kafka.</p>
<p>This file can be directly applied using <code>oc apply -f /tmp/kafkacfg-amqstreams-system.yaml</code> or added to the <code>mas_config</code> list variable used by the <code>ibm.mas_devops.suite_install</code> role to deploy and configure MAS.</p>
</div>
<h2 id="install-mongodb-ce">Install MongoDb (CE)<a class="headerlink" href="#install-mongodb-ce" title="Permanent link"></a></h2>
<h3 id="required-environment-variables_1">Required environment variables<a class="headerlink" href="#required-environment-variables_1" title="Permanent link"></a></h3>
<ul>
<li><code>MAS_INSTANCE_ID</code> sets the instance ID of the MAS install that we are configuring</li>
</ul>
<h3 id="optional-environment-variables_1">Optional environment variables<a class="headerlink" href="#optional-environment-variables_1" title="Permanent link"></a></h3>
<ul>
<li><code>MONGODB_NAMESPACE</code> overrides the Kubernetes namespace where the MongoDb CE operator will be installed, this will default to <code>mongoce</code></li>
</ul>
<h3 id="example-usage_1">Example usage<a class="headerlink" href="#example-usage_1" title="Permanent link"></a></h3>
<p>MongoDb CE operator will be installed into the <code>mongoce</code> namespace, a 3 node cluster cluster will be created.  The cluster will bind six 20GB PVCs of the default storage class, these provide persistence for the data and system logs across the three nodes.</p>
<pre><code class="language-bash">export MAS_INSTANCE_ID=masdev1

ansible-playbook playbooks/dependencies/install-mongodb-ce.yml
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The playbook will generate a yaml file containing the definition of a Secret and MongoCfg resource that can be used to configure the deployed instance as the MAS system MongoDb.</p>
<p>This file can be directly applied using <code>oc apply -f /tmp/mongocfg-mongoce-system.yaml</code> or added to the <code>mas_config</code> list variable used by the <code>ibm.mas_devops.suite_install</code> role to deploy and configure MAS.</p>
</div>
<h2 id="install-bas">Install BAS<a class="headerlink" href="#install-bas" title="Permanent link"></a></h2>
<p>Installs <strong>IBM Behavior Analytics Services</strong> on IBM Cloud Openshift Clusters (ROKS) and generates configuration that can be directly applied to IBM Maximo Application Suite.</p>
<p>Before you use this playbook you will likely want to edit the <code>mas_config_dir</code> variable to supply your own configuration, instead of the sample data provided.
This is the directory where this playbook will store BAS configurations such as BAS endpoint and username/password credentials to configure BAS in your Maximo Application Suite instance.</p>
<h3 id="required-environment-variables_2">Required environment variables<a class="headerlink" href="#required-environment-variables_2" title="Permanent link"></a></h3>
<ul>
<li><code>BAS_CONTACT_MAIL</code> Defines the email for person to contact for BAS</li>
<li><code>BAS_CONTACT_FIRSTNAME</code> Defines the first name of the person to contact for BAS</li>
<li><code>BAS_CONTACT_LASTNAME</code> Defines the last name of the person to contact for BAS</li>
</ul>
<h3 id="optional-environment-variables_2">Optional environment variables<a class="headerlink" href="#optional-environment-variables_2" title="Permanent link"></a></h3>
<ul>
<li><code>BAS_USERNAME</code> BAS default username. If not provided, default username will be <code>basuser</code>.</li>
<li><code>BAS_PASSWORD</code> Defines the password for your BAS instance. If not provided, a random 15 character password will be generated.</li>
<li><code>BAS_GRAFANA_USERNAME</code> Defines the username for the BAS Graphana instance, default is <code>basuser</code>.</li>
<li><code>BAS_GRAFANA_PASSWORD</code> Defines the password for BAS Graphana dashboard. If not provided, a random 15 character password will be generated</li>
<li><code>BAS_NAMESPACE</code> Defines the targetted cluster namespace/project where BAS will be installed. If not provided, default BAS namespace will be 'ibm-bas'.</li>
</ul>
<h3 id="usage">Usage:<a class="headerlink" href="#usage" title="Permanent link"></a></h3>
<pre><code class="language-bash">export BAS_NAMESPACE=ibm-bas
export BAS_USER=basuser
export BAS_PASSWORD=xxx
export BAS_GRAFANA_USER=basuser
export BAS_GRAFANA_PASSWORD=xxx
export BAS_CONTACT_MAIL=xxx@xxx.com
export BAS_CONTACT_FIRSTNAME=xxx
export BAS_CONTACT_LASTNAME=xxx

ansible-playbook playbooks/dependencies/install-bas.yml
</code></pre>
<h2 id="install-sls">Install SLS<a class="headerlink" href="#install-sls" title="Permanent link"></a></h2>
<p>Before you use this playbook you will likely want to edit the <code>mas_config_dir</code> variable to supply your own configuration, instead of the sample data provided.</p>
<h3 id="required-environment-variables_3">Required environment variables<a class="headerlink" href="#required-environment-variables_3" title="Permanent link"></a></h3>
<ul>
<li><code>SLS_ENTITLEMENT_KEY</code> Provide your IBM entitlement key</li>
</ul>
<h3 id="optional-environment-variables_3">Optional environment variables<a class="headerlink" href="#optional-environment-variables_3" title="Permanent link"></a></h3>
<ul>
<li><code>SLS_CATALOG_SOURCE</code> Set to <code>ibm-sls-operators</code> if you want to deploy pre-release development builds</li>
<li><code>SLS_CHANNEL</code> Override the default release channel (3.x)</li>
<li><code>SLS_ICR_CP</code> Override the registry source for all container images deployed by the SLS operator</li>
<li><code>SLS_ICR_CPOPEN</code> Override the registry source for all container images deployed by the SLS operator</li>
<li><code>SLS_ENTITLEMENT_USERNAME</code> Override the default entitlement username (cp)</li>
<li><code>SLS_NAMESPACE</code> Override the default entitlement username (ibm-sls)</li>
<li><code>SLS_STORAGE_CLASS</code> Defines Storage Class to be used by SLS Persistent Volumes</li>
<li><code>SLS_LICENSE_ID</code> Must be set to the license id specified in the license file when one is provided</li>
<li><code>SLS_REGISTRATION_KEY</code> optional var when you want to install sls using a registration key you have.</li>
</ul>
<h3 id="example-usage-release-build">Example usage: release build<a class="headerlink" href="#example-usage-release-build" title="Permanent link"></a></h3>
<pre><code class="language-bash">export SLS_INSTANCE_ID=xxx
export SLS_ENTITLEMENT_KEY=xxx
export SLS_STORAGE_CLASS=xxx

ansible-playbook playbooks/dependencies/install-sls.yml
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lookup your entitlement key from the <a href="https://myibm.ibm.com/products-services/containerlibrary">IBM Container Library</a></p>
</div>
<h3 id="example-usage-pre-release-build">Example usage: pre-release build<a class="headerlink" href="#example-usage-pre-release-build" title="Permanent link"></a></h3>
<pre><code class="language-bash">export SLS_CATALOG_SOURCE=ibm-sls-operators
export SLS_CHANNEL=3.1.0-pre.stable
export SLS_INSTANCE_ID=xxx

export SLS_ICR_CP=wiotp-docker-local.artifactory.swg-devops.com
export SLS_ICR_CPOPEN=wiotp-docker-local.artifactory.swg-devops.com
export SLS_ENTITLEMENT_USERNAME=$W3_USERNAME_LOWERCASE
export SLS_ENTITLEMENT_KEY=$ARTIFACTORY_APIKEY
export SLS_STORAGE_CLASS=xxx


ansible-playbook playbooks/dependencies/install-sls.yml
</code></pre>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You must have already installed the development (pre-release) catalogs, pre-release builds are not available directly from the IBM Operator Catalog.</p>
</div>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/ansible-devops/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../ocp/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../cp4d/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
